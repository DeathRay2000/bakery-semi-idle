<body>
    <div id = 'playerinfo'></div>
    <div id = 'gold'></div>
    <div id = 'exp'></div>
    <div id = 'list'></div>
    <div id = 'plots'></div>
    <div id = 'sell'></div>
    <div id = 'ovenlist'></div>
    <div id = 'ovens'></div>
    <div id = 'unlockablecrops'></div>
    <div id = 'unlockablerecipes'></div>

    <div id = 'kitten'>Pet me!</div>
</body>
    
    <script>
    gold = 100
    exp = 0
    function getGold(){
        let thegoldlist = document.getElementById('gold')
        
        let Gold = document.createElement('div')
        Gold.innerText = 'Gold: ' + JSON.stringify(gold)
        
        
        thegoldlist.append(Gold)
        
    }
    function GetExp(){
        let theexplist = document.getElementById('exp')
        let Exp = document.createElement('div')
        Exp.innerText = 'EXP: ' + JSON.stringify(exp)
        theexplist.append(Exp)

    }
    const sell = (e)=> {
        
        amountsold = document.createElement('input')
        amountsold.setAttribute('type', 'number')
        sell = document.getElementById('list')
        sell.append(amountsold)
        console.log(amountsold)
        let sellAmount = amountsold.value
        
        console.log(list.hasChildNodes)
        console.log(sellAmount)
        sell.addEventListener("keypress", function (e){
                sellAmount = amountsold.value
                
                if (e.key === "Enter"){
                if(sellAmount > crop.amount){
                    alert('Insufficient ' + crop.name)
                }
                else{
                    crop.amount = crop.amount - sellAmount
                    gold = gold + (sellAmount * crop.value)
                    exp += crop.expyield
                    console.log(sellAmount)
                    sell.querySelectorAll('*').forEach(n => n.remove());
                    console.log(list.children)
                    
                    for(let i = 0; i < croplist.length; i++){
                    let item = document.createElement('div', classname = 'item')
                    item.innerText = croplist[i].name + ': ' + JSON.stringify(croplist[i].amount)
                    list.append(item)
                    sellbutton = document.createElement('button')
                    sellbutton.innerText = 'SELL'
                    sellbutton.addEventListener('click',()=> sell(croplist[i]))
                    
            }
                getGold()
                }  
                }
               
            
            
            
      })
    }
    function crop(name, cost, time, yield, expyield, value){

        this.name = name
        this.cost = cost
        this.time = time
        this.yield = yield
        this.expyield = expyield
        this.value = value
        this.amount = 2
        let theelement = document.createElement('div', id = name)
        console.log(theelement)
        let list = document.getElementById('list')
        theelement.innertext = this.name + ": " + JSON.stringify(this.value)
        list.append(theelement)
        console.log(this.amount)
    }

      
  
        
    
    const wheat = new crop('wheat', 10, 15, 3, 1, 5)
    const sugarcane = new crop('sugarcane',15, 15, 4, 2, 10)
    list = document.getElementById('list')

    croplist = [wheat, sugarcane]
    function list(croplist){
        list = document.getElementById('list')
        
        while(list.lastElementChild()){
            list.removeChild(list.lastElementChild)
        }
        for(let i = 0; i < croplist.length; i++){
            item = document.createElement('div', classname = 'item')
            item.innerText = croplist[i].name + ': ' + JSON.stringify(croplist[i].amount)
            list.append(item)
        }
        let goldlist = document.createElement('div', classname = 'gold')
        goldlist.innerText = 'gold' + JSON.stringify(gold)
        list.append(goldlist)
}
    console.log(croplist)

    function unlockableCrop(unlockcost, minexp, name, cost, time, yield, expyield, value){
        this.unlockcost = unlockcost
        this.minexp = minexp 
        this.name = name
        this.cost = cost
        this.time = time
        this.yield = yield
        this.expyield = expyield
        this.value = value
        this.amount = 2
        this.unlockswitch = document.createElement('div', classname = 'unlockswitch')
        this.unlockswitch.style.height = '200px'
        this.unlockswitch.style.width = '200px'
        this.unlockswitch.background = 'gold'
        this.unlockswitch.innerText = "UNLOCKABLE: " + this.name + " Unlock Cost: "+ JSON.stringify(this.unlockcost)+' Minimun exp needed: ' + JSON.stringify(this.minexp)
        this.unlockswitch.addEventListener('click', () => this.unlock())
        this.unlocklist = document.getElementById('unlockablecrops')
        this.unlocklist.append(unlockswitch)
        this.unlock = function(){
            if(exp < this.minexp){
                alert('Insufficient EXP')
            }
            else if(gold < this.unlockcost){
                alert('Insufficient gold')
            }
            else{
                gold = gold - this.unlockcost
                newCrop = new crop(this.name, this.cost, this.time, this.yield, this.expyield, this.value)
                croplist.push(newCrop)
                unlockswitch.remove()

            }
        }

    }
    watermelon = unlockableCrop(500, 250, 'watermelon', 50, 120, 1, 10, 65)
    
     function field(croplist){
        croplist = [wheat, sugarcane]
        plots = document.getElementById('plots')
        console.log(plots)
        this.fieldElement = document.createElement('div', classname = 'field')
        this.fieldElement.style.height = '100px'
        this.fieldElement.style.width = '100px'
        this.fieldElement.style.background = 'brown'
        this.fieldElement.innerText = 'Not In Use'
        this.crop = null
        if(this.crop ==null){this.fieldElement.addEventListener('click',() => this.plant())}
        else{this.fieldElement.removeEventListener('click',() => this.plant())}
        this.harvest = function(crop){
            croplist = [wheat, sugarcane]
            this.crop.amount += this.crop.yield
            exp += this.crop.expyield
            this.crop = null
            console.log(this.crop)
            this.fieldElement.innerText = 'Not In Use'
            // this.fieldElement.addEventListener('click',() => this.plant())
            list = document.getElementById('list')
            GetExp()
               console.log(list.children) 
                // while(list.lastElementChild){
                //     console.log(list.lastElementChild)
                //     list.removeChild(list.lastElementChild)
                //     console.log(list.lastElementChild)
                //     console.log('n')
                // }
                list.innerText = ''
                list.querySelectorAll('*').forEach(n => n.remove());
                
        let goldlist = document.createElement('div', classname = 'gold')
        goldlist.innerText = 'gold' + JSON.stringify(gold)
        list.append(goldlist)
            for(let i = 0; i < croplist.length; i++){
                item = document.createElement('div', classname = 'item')
                item.innerText = croplist[i].name + ': ' + JSON.stringify(croplist[i].amount)
                list.append(item)
                sellbutton = document.createElement('button' )
                sellbutton.innerText = 'SELL'
                sellbutton.addEventListener('click',()=> sell(croplist[i]))
                list.append(sellbutton)
            }
            
        }
        
        
        this.grow = function(crop){
            list.querySelectorAll('*').forEach(n => n.remove());
            
            this.crop = crop
            if(gold < this.crop.cost){
                alert('Insufficient Gold')
               
            }
            else{
                gold -= this.crop.cost
            
            
            this.fieldElement.innerText = crop.name + 'growing'
            console.log(this.FieldElement)
            timeLeft = setTimeout(() => {
                
                this.fieldElement.addEventListener('click', ()=> this.harvest(crop)) 
                this.fieldElement.innerText= 'Ready to harvest'
            }, 1000  )
            }
            
    
        }
        this.plant = function(croplist){
            console.log('plant')
            croplist = [wheat, sugarcane]
            console.log(croplist)
            let plantSelection = document.getElementById('list')
            for (let i = 0; i < croplist.length; i++ ){
                console.log(croplist)
                let button = document.createElement('button')
                console.log(button)
                console.log(plantSelection)
                button.innerText= croplist[i].name
                button.addEventListener('click',() => this.grow(croplist[i]))
                plantSelection.append(button)
    
            }
    
        }
        
    
        plots.append(this.fieldElement)
        
    
    }
    
    let field1 = new field(croplist)
   
    function recipe(name, ingredients, value, time, expyield){
        this.name = name
        this.ingredients = ingredients
        console.log(ingredients)
        console.log(this.ingredients)
        this.value = value
        this.time = time
        this.expyield = expyield
        this.amount = 3

    }
    function oven(recipelist){
        
        ovens = document.getElementById('ovens')
        console.log(ovens)
        this.ovenElement = document.createElement('div', classname = 'oven')
        this.ovenElement.style.height = '100px'
        this.ovenElement.style.width = '100px'
        this.ovenElement.style.background = 'gray'
        this.ovenElement.innerText = 'Not In Use'
        console.log(this.ovenElement)
        this.recipe = null
        if(this.recipe ==null){this.ovenElement.addEventListener('click',() => this.putin())}
        else{this.ovenElement.removeEventListener('click',() => this.putin())}
        this.takeout = function(){
            recipelist = [flour, sugar, bread, sugarcookies]
            this.recipe.amount += 1
            exp += this.recipe.expyield
            this.recipe = null
            console.log(this.recipe)
            this.ovenElement.innerText = 'Not In Use'
            // this.fieldElement.addEventListener('click',() => this.plant())
            list = document.getElementById('ovenlist')
            
               console.log(list.children) 
                // while(list.lastElementChild){
                //     console.log(list.lastElementChild)
                //     list.removeChild(list.lastElementChild)
                //     console.log(list.lastElementChild)
                //     console.log('n')
                // }
                list.innerText = ''
                list.querySelectorAll('*').forEach(n => n.remove());
                
        
            for(let i = 0; i < recipelist.length; i++){
                item = document.createElement('div', classname = 'item')
                item.innerText = recipelist[i].name + ': ' + JSON.stringify(recipelist[i].amount)
                list.append(item)
                sellbutton = document.createElement('button' )
                sellbutton.innerText = 'SELL'
                sellbutton.addEventListener('click',()=> sell(recipelist[i]))
                list.append(sellbutton)
            }
            
        }
        
        
        this.bake = function(recipe){
            // list.querySelectorAll('*').forEach(n => n.remove());
            
            console.log(recipe)
            console.log(recipe.ingredients)
            this.recipe = recipe
            let sufficientIngredients = true
            
            for(let i = 0; i < recipe.ingredients.length; i++){
                let callsfor = 0
                for(let j = 0; j < recipe.ingredients.length; j++){
                    if(recipe.ingredients.i == recipe.ingredients.j){
                        callsfor += 1
                    }
                }
                if(recipe.ingredients[i].amount < callsfor){
                        sufficientIngredients = false
                        
                    }

                    
            }
            if(sufficientIngredients == true){
                for(let i = 0; i < recipe.ingredients.length; i++){
                    console.log(sugar.amount)
                    console.log(flour.amount)
                    console.log(recipe.ingredients[i])
                    recipe.ingredients[i].amount = recipe.ingredients[i].amount - 1
                }
                this.ovenElement.innerText = recipe.name + 'baking'
            console.log(this.FieldElement)
            timeLeft = setTimeout(() => {
                
                this.ovenElement.addEventListener('click', ()=> this.takeout(recipe)) 
                this.ovenElement.innerText= 'Finished!'
            }, 1000  )
            
            }
            else{
                alert('Insufficient ingredients')
            }
            
            
           
            }
            
    
        
        this.putin = function(recipelist){
            
            recipelist = [flour, sugar, bread, sugarcookies]
            console.log(recipelist)
            for(let i = 0; i < recipelist.length; i++){
                console.log(recipelist[i])
            }
            let recipeSelection = document.getElementById('ovenlist')
            for (let i = 0; i < recipelist.length; i++ ){
                console.log(recipelist)
                let button = document.createElement('button')
                console.log(button)
                console.log(recipeSelection)
                button.innerText= recipelist[i].name
                button.addEventListener('click',() => this.bake(recipelist[i]))
                recipeSelection.append(button)
    
            }

            
    
        }
        ovens.append(this.ovenElement)
    
    }
    
    const flour = new recipe('flour',[wheat], 10, 30, 2)
    const sugar = new recipe('sugar',[sugarcane], 20, 60, 5)
    const bread = new recipe('bread',[flour], 15, 75, 7)
    const sugarcookies = new recipe('Sugar Cookies',[flour,sugar], 45, 90, 12)
    console.log(flour.ingredients)
    console.log(sugarcookies.ingredients)
    // ingredientlist = [wheat, sugarcane, flour, sugar]


    getGold()
    GetExp()

    recipelist = [flour, sugar, bread, sugarcookies]
    console.log(field1.crop)
    let oven1 = new oven([flour, sugar, bread, sugarcookies])
    

    
    

    

    </script>